<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Deep Learning Course3 Week1 Programming Assignment2 | Jin Wang</title>
  <meta name="keywords" content=" Tensorflow , Machine Learning , Deep Learning , Convolutional Neural Network ">
  <meta name="description" content="Deep Learning Course3 Week1 Programming Assignment2 | Jin Wang">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="HiHi，你好，我是王金，大学生一枚，主修 EE &amp;amp; CS &amp;amp; Finance。平时喜欢搞搞硬件学学软件，喜欢追逐梦想，也喜欢有梦想的人。 课余时间研究有Machine Learning、Deep Learning、OpenCV、Linux、Web、C、C++、Python、HTML、CSS、JS。懂得不多，但是在不断的学习～ 希望我们在奋斗的道路上，都能找到属于自己的归属 Edu">
<meta property="og:type" content="website">
<meta property="og:title" content="about">
<meta property="og:url" content="http://www.jinwang.world/about/index.html">
<meta property="og:site_name" content="Jin Wang">
<meta property="og:description" content="HiHi，你好，我是王金，大学生一枚，主修 EE &amp;amp; CS &amp;amp; Finance。平时喜欢搞搞硬件学学软件，喜欢追逐梦想，也喜欢有梦想的人。 课余时间研究有Machine Learning、Deep Learning、OpenCV、Linux、Web、C、C++、Python、HTML、CSS、JS。懂得不多，但是在不断的学习～ 希望我们在奋斗的道路上，都能找到属于自己的归属 Edu">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-08-16T19:52:52.641Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="about">
<meta name="twitter:description" content="HiHi，你好，我是王金，大学生一枚，主修 EE &amp;amp; CS &amp;amp; Finance。平时喜欢搞搞硬件学学软件，喜欢追逐梦想，也喜欢有梦想的人。 课余时间研究有Machine Learning、Deep Learning、OpenCV、Linux、Web、C、C++、Python、HTML、CSS、JS。懂得不多，但是在不断的学习～ 希望我们在奋斗的道路上，都能找到属于自己的归属 Edu">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.0.1" rel="stylesheet">

<link href="/css/hl_theme/atom-light.css?v=1.0.1" rel="stylesheet">

<link href="//cdn.bootcss.com/animate.css/3.5.2/animate.min.css" rel="stylesheet">
<link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="/js/jquery.autocomplete.min.js?v=1.0.1" ></script>

<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js"></script>



<script src="//cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.0.1" ></script>

</head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="false">
  <input class="theme_blog_path" value="">
</div>

<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/" class="avatar_target">
    <img class="avatar" src="/img/avatar.jpg" />
</a>
<div class="author">
    <span>Jin Wang</span>
</div>

<div class="icon">
    
        
        <a title="rss" href="/atom.xml" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-rss"></use>
                </svg>
            
        </a>
        
    
        
        <a title="github" href="https://github.com/TFprimeWJ" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-github"></use>
                </svg>
            
        </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
        <a title="jianshu" href="https://www.jianshu.com/u/410d0d460658" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-jianshu"></use>
                </svg>
            
        </a>
        
    
        
        <a title="zhihu" href="https://www.zhihu.com/people/tfprime/activities" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-zhihu"></use>
                </svg>
            
        </a>
        
    
        
    
        
    
        
    
        
        <a title="email" href="mailto:jw.tfprime@qq.com" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-email"></use>
                </svg>
            
        </a>
        
    
        
        <a title="qq" href="http://wpa.qq.com/msgrd?v=3&uin=1712297111&site=qq&menu=yes" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-qq"></use>
                </svg>
            
        </a>
        
    
        
    
</div>




<ul>
    <li><div class="all active">全部文章<small>(33)</small></div></li>
    
        
            
            <li><div data-rel="Python">Python<small>(6)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="Tensorflow">Tensorflow<small>(5)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="DSP"><i class="fold iconfont icon-right"></i>DSP<small>(1)</small></div>
                
                    <ul class="sub hide">
                        
                        <li><div data-rel="Matlab">Matlab<small>(1)</small></div>
                            
                        </li>
                            
                    </ul>
                
            </li>
            
        
    
        
            
            <li><div data-rel="Communication System"><i class="fold iconfont icon-right"></i>Communication System<small>(1)</small></div>
                
                    <ul class="sub hide">
                        
                        <li><div data-rel="Matlab">Matlab<small>(1)</small></div>
                            
                        </li>
                            
                    </ul>
                
            </li>
            
        
    
        
            
            <li><div data-rel="Digital Image Processing">Digital Image Processing<small>(3)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="Pandas">Pandas<small>(3)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="Digital Signal Processing">Digital Signal Processing<small>(1)</small></div>
                
            </li>
            
        
    
        
            
        
    
        
            
            <li><div data-rel="Web Development">Web Development<small>(0)</small></div>
                
            </li>
            
        
    
        
            
        
    
        
            
            <li><div data-rel="Leetcode">Leetcode<small>(6)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="JZOffer">JZOffer<small>(1)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="Keras">Keras<small>(1)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="GRE">GRE<small>(1)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="Machine Learning">Machine Learning<small>(2)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="WebDevelopment">WebDevelopment<small>(2)</small></div>
                
            </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
    
    
    
    
    </div>
    <div><a class="about  hasFriend  site_url"  href="/about">关于</a><a style="width: 50%"  class="friends">友链</a></div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="33">

<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        友情链接
        <i class="back-title-list"></i>
    </div>
    <div class="friends-content">
        <ul>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <form onkeydown="if(event.keyCode==13){return false;}">
        <input class="search" type="text" placeholder="Search..." autocomplete="off"id="local-search-input" >
        <i class="cross"></i>
        <span>
            <label for="tagswitch">Tags:</label>
            <input id="tagswitch" type="checkbox" style="display: none" />
            <i id="tagsWitchIcon"></i>
        </span>
    </form>
    <div class="tags-list">
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color2">Python</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">Stanford</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color1">Tensorflow</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">DSP</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color2">Matlab</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color1">Communication System</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">Random Process</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">Digital Image Processing</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color2">Pandas</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color1">Digital Signal Processing</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">DTFT</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">Json</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">csv</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color3">爬虫</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">API</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color2">Nodejs</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color1">Web Development</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">Dynamic Programming</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">Leetcode</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color2">Binary Tree</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color1">Queue</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color1">BinaryTree</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">Recursion</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">Iteration</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">Binary Search</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color1">Keras</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color2">Machine Learning</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">GRE</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">GRE Issue</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">Deep Learning</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">Convolutional Neural Network</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">WebDevelopment</a>
    </li>
    
    <div class="clearfix"></div>
</div>

    
    <nav id="title-list-nav">
        
        <a  class="Python "
           href="/2018/08/19/2018-08-19-Python学习-深浅copy/"
           data-tag="Python"
           data-author="" >
            <span class="post-title" title="Python学习-深浅copy">Python学习-深浅copy</span>
            <span class="post-date" title="2018-08-19 00:00:00">2018/08/19</span>
        </a>
        
        <a  class="Python "
           href="/2018/08/19/2018-08-19-Python学习—assert/"
           data-tag="Python"
           data-author="" >
            <span class="post-title" title="Python学习-assert的作用">Python学习-assert的作用</span>
            <span class="post-date" title="2018-08-19 00:00:00">2018/08/19</span>
        </a>
        
        <a  class="Tensorflow "
           href="/2018/08/18/2018-08-20-CS20学习笔记（一）/"
           data-tag="Stanford,Tensorflow"
           data-author="" >
            <span class="post-title" title="CS20学习笔记（一）">CS20学习笔记（一）</span>
            <span class="post-date" title="2018-08-18 00:00:00">2018/08/18</span>
        </a>
        
        <a  class="Tensorflow "
           href="/2018/08/20/2018-08-21-CS20学习笔记（三）/"
           data-tag="Stanford,Tensorflow"
           data-author="" >
            <span class="post-title" title="CS20学习笔记（三）">CS20学习笔记（三）</span>
            <span class="post-date" title="2018-08-20 00:00:00">2018/08/20</span>
        </a>
        
        <a  class="DSP Matlab "
           href="/2018/09/09/2018-09-09-Digital_Signal_Processing_Using_Matlab_Problem_2_1/"
           data-tag="DSP,Matlab"
           data-author="" >
            <span class="post-title" title="Digital Signal Processing Using Matlab Problem 2.1 Solutions &amp; Results">Digital Signal Processing Using Matlab Problem 2.1 Solutions &amp; Results</span>
            <span class="post-date" title="2018-09-09 00:00:00">2018/09/09</span>
        </a>
        
        <a  class="Tensorflow "
           href="/2018/08/22/2018-08-21-CS20学习笔记（五）/"
           data-tag="Stanford,Tensorflow"
           data-author="" >
            <span class="post-title" title="CS20学习笔记（五）">CS20学习笔记（五）</span>
            <span class="post-date" title="2018-08-22 00:00:00">2018/08/22</span>
        </a>
        
        <a  class="Tensorflow "
           href="/2018/08/21/2018-08-21-CS20学习笔记（四）/"
           data-tag="Python,Stanford,Tensorflow"
           data-author="" >
            <span class="post-title" title="CS20学习笔记（四）">CS20学习笔记（四）</span>
            <span class="post-date" title="2018-08-21 00:00:00">2018/08/21</span>
        </a>
        
        <a  class="Communication System Matlab "
           href="/2018/09/13/2018-09-13-Communication_System-Random_Process/"
           data-tag="Matlab,Communication System,Random Process"
           data-author="" >
            <span class="post-title" title="Communication System Random Process: A cos wave with random phase">Communication System Random Process: A cos wave with random phase</span>
            <span class="post-date" title="2018-09-13 00:00:00">2018/09/13</span>
        </a>
        
        <a  class="Digital Image Processing "
           href="/2018/09/25/2018-09-25-Digital_Image_Processing_Ch1_Introduction/"
           data-tag="Matlab,Digital Image Processing"
           data-author="" >
            <span class="post-title" title="Digital Image Processing - Ch1 Introduction">Digital Image Processing - Ch1 Introduction</span>
            <span class="post-date" title="2018-09-25 00:00:00">2018/09/25</span>
        </a>
        
        <a  class="Digital Image Processing "
           href="/2018/09/26/2018-09-26-Digital_Image_Processing_Ch2_Fundamentals/"
           data-tag="Matlab,Digital Image Processing"
           data-author="" >
            <span class="post-title" title="Digital Image Processing - Ch2 Fundamentals">Digital Image Processing - Ch2 Fundamentals</span>
            <span class="post-date" title="2018-09-26 00:00:00">2018/09/26</span>
        </a>
        
        <a  class="Pandas "
           href="/2018/10/21/2018-10-21-Pandas学习-DataFrame()按列索引/"
           data-tag="Pandas"
           data-author="" >
            <span class="post-title" title="Pandas学习-DataFrame()按列索引">Pandas学习-DataFrame()按列索引</span>
            <span class="post-date" title="2018-10-21 00:00:00">2018/10/21</span>
        </a>
        
        <a  class="Digital Signal Processing "
           href="/2018/09/24/2018-09-24-DTFT_Implementation_Using_Matlab/"
           data-tag="Matlab,Digital Signal Processing,DTFT"
           data-author="" >
            <span class="post-title" title="DTFT Implementation Using Matlab">DTFT Implementation Using Matlab</span>
            <span class="post-date" title="2018-09-24 00:00:00">2018/09/24</span>
        </a>
        
        <a  class="Pandas "
           href="/2018/10/21/2018-10-21-Pandas学习-pd.read_csv()添加header和names/"
           data-tag="Python,Pandas"
           data-author="" >
            <span class="post-title" title="Pandas学习-pd.read_csv()添加header和names">Pandas学习-pd.read_csv()添加header和names</span>
            <span class="post-date" title="2018-10-21 00:00:00">2018/10/21</span>
        </a>
        
        <a  class="Python "
           href="/2018/10/21/2018-10-21-Python学习-将逗号分隔的字符串转化为列表/"
           data-tag="Python"
           data-author="" >
            <span class="post-title" title="Python学习-将逗号分隔的字符串转化为列表">Python学习-将逗号分隔的字符串转化为列表</span>
            <span class="post-date" title="2018-10-21 00:00:00">2018/10/21</span>
        </a>
        
        <a  class="Python "
           href="/2018/10/28/2018-10-28-Python学习-json.dumps和json.loads的用法/"
           data-tag="Python,Json"
           data-author="" >
            <span class="post-title" title="Python学习-json.dumps和json.loads的用法">Python学习-json.dumps和json.loads的用法</span>
            <span class="post-date" title="2018-10-28 00:00:00">2018/10/28</span>
        </a>
        
        <a  class="Pandas "
           href="/2018/10/22/2018-10-22-Pandas学习-Series转成str操作-读取gps/"
           data-tag="Pandas,csv"
           data-author="" >
            <span class="post-title" title="Pandas学习-Series()转成str操作，读取gps">Pandas学习-Series()转成str操作，读取gps</span>
            <span class="post-date" title="2018-10-22 00:00:00">2018/10/22</span>
        </a>
        
        <a  class="Python "
           href="/2018/10/28/2018-10-28-Python学习-写json爬虫/"
           data-tag="Python,Json,爬虫,API"
           data-author="" >
            <span class="post-title" title="Python学习 - 写json爬虫">Python学习 - 写json爬虫</span>
            <span class="post-date" title="2018-10-28 00:00:00">2018/10/28</span>
        </a>
        
        <a  class="Python "
           href="/2018/10/28/2018-10-28-Python学习-将dict写入txt文件/"
           data-tag="Python"
           data-author="" >
            <span class="post-title" title="Python学习-将dict写入txt文件">Python学习-将dict写入txt文件</span>
            <span class="post-date" title="2018-10-28 00:00:00">2018/10/28</span>
        </a>
        
        <a  class="WebDevelopment "
           href="/2019/10/06/2019-10-06-Node-Introduction/"
           data-tag="Nodejs,WebDevelopment"
           data-author="" >
            <span class="post-title" title="What is Nodejs? - A beginner&#39;s View">What is Nodejs? - A beginner&#39;s View</span>
            <span class="post-date" title="2019-10-06 00:00:00">2019/10/06</span>
        </a>
        
        <a  class="Leetcode "
           href="/2019/10/07/2019-10-07-LC53-Maximum-Subarray/"
           data-tag="Dynamic Programming,Leetcode"
           data-author="" >
            <span class="post-title" title="Leetcode 53 Maximum Subarray">Leetcode 53 Maximum Subarray</span>
            <span class="post-date" title="2019-10-07 00:00:00">2019/10/07</span>
        </a>
        
        <a  class="JZOffer "
           href="/2019/10/17/2019-10-17-JZOffer_BinaryTreePrintFromTopToBottom/"
           data-tag="Binary Tree,Queue"
           data-author="" >
            <span class="post-title" title="剑指Offer 从上到下打印二叉树">剑指Offer 从上到下打印二叉树</span>
            <span class="post-date" title="2019-10-17 00:00:00">2019/10/17</span>
        </a>
        
        <a  class="Leetcode "
           href="/2019/10/17/2019-10-17-LC145_Binary_Tree_Postrder_Traversal/"
           data-tag="Leetcode,BinaryTree,Recursion,Iteration"
           data-author="" >
            <span class="post-title" title="Leetcode 145 Binary Tree Postorder Traversal">Leetcode 145 Binary Tree Postorder Traversal</span>
            <span class="post-date" title="2019-10-17 00:00:00">2019/10/17</span>
        </a>
        
        <a  class="Leetcode "
           href="/2019/10/17/2019-10-17-LC35_Search_Insert_Position/"
           data-tag="Binary Search"
           data-author="" >
            <span class="post-title" title="LC 35 Search Insert Position">LC 35 Search Insert Position</span>
            <span class="post-date" title="2019-10-17 00:00:00">2019/10/17</span>
        </a>
        
        <a  class="WebDevelopment "
           href="/2019/09/29/2019-9-29-First-Express-App/"
           data-tag="WebDevelopment"
           data-author="" >
            <span class="post-title" title="First Express App">First Express App</span>
            <span class="post-date" title="2019-09-29 00:00:00">2019/09/29</span>
        </a>
        
        <a  class="Leetcode "
           href="/2019/10/17/2019-10-17-LC589_N_ary_Tree_Preorder_Traversal/"
           data-tag="Leetcode,BinaryTree,Recursion,Iteration"
           data-author="" >
            <span class="post-title" title="Leetcode 589 N-ary Tree Preorder Traversal">Leetcode 589 N-ary Tree Preorder Traversal</span>
            <span class="post-date" title="2019-10-17 00:00:00">2019/10/17</span>
        </a>
        
        <a  class="Leetcode "
           href="/2019/10/17/2019-10-17-LC44_Binary_Tree_Preorder_Traversal/"
           data-tag="Leetcode,BinaryTree,Recursion,Iteration"
           data-author="" >
            <span class="post-title" title="Leetcode 144 Binary Tree Preorder Traversal">Leetcode 144 Binary Tree Preorder Traversal</span>
            <span class="post-date" title="2019-10-17 00:00:00">2019/10/17</span>
        </a>
        
        <a  class="Leetcode "
           href="/2019/10/17/2019-10-17-LC94_Binary_Tree_Inorder_Traversal/"
           data-tag="Leetcode,BinaryTree,Recursion,Iteration"
           data-author="" >
            <span class="post-title" title="Leetcode 94 Binary Tree Inorder Traversal">Leetcode 94 Binary Tree Inorder Traversal</span>
            <span class="post-date" title="2019-10-17 00:00:00">2019/10/17</span>
        </a>
        
        <a  class="Keras "
           href="/2018/08/18/2018-08-18-Keras学习之路（一）/"
           data-tag="Keras,Machine Learning"
           data-author="" >
            <span class="post-title" title="Keras学习之路（一）">Keras学习之路（一）</span>
            <span class="post-date" title="2018-08-18 00:00:00">2018/08/18</span>
        </a>
        
        <a  class="Tensorflow "
           href="/2018/08/19/2018-08-20-CS20学习笔记（二）/"
           data-tag="Stanford,Tensorflow"
           data-author="" >
            <span class="post-title" title="CS20学习笔记（二）">CS20学习笔记（二）</span>
            <span class="post-date" title="2018-08-19 00:00:00">2018/08/19</span>
        </a>
        
        <a  class="Digital Image Processing "
           href="/2018/09/27/2018-09-27-Digital_Image_Processing_Ch3_Spatial_Domain_Image_Enhancement/"
           data-tag="Matlab,Digital Image Processing"
           data-author="" >
            <span class="post-title" title="Digital Image Processing - Ch3 Spatial Domain Image Enhancement">Digital Image Processing - Ch3 Spatial Domain Image Enhancement</span>
            <span class="post-date" title="2018-09-27 00:00:00">2018/09/27</span>
        </a>
        
        <a  class="GRE "
           href="/2018/08/09/2018-08-09-GRE-AWA-MODEL-ESSAYS-ISSUE-1/"
           data-tag="GRE,GRE Issue"
           data-author="" >
            <span class="post-title" title="GRE AWA MODEL ESSAYS">GRE AWA MODEL ESSAYS</span>
            <span class="post-date" title="2018-08-09 00:00:00">2018/08/09</span>
        </a>
        
        <a  class="Machine Learning "
           href="/2018/08/16/2018-08-15-Convolution+model+-+Application+-+v1/"
           data-tag="Tensorflow,Machine Learning,Deep Learning,Convolutional Neural Network"
           data-author="" >
            <span class="post-title" title="Deep Learning Course3 Week1 Programming Assignment2">Deep Learning Course3 Week1 Programming Assignment2</span>
            <span class="post-date" title="2018-08-16 00:00:00">2018/08/16</span>
        </a>
        
        <a  class="Machine Learning "
           href="/2018/08/15/2018-08-15-Convolution model - Step by Step - v2/"
           data-tag="Machine Learning,Deep Learning"
           data-author="" >
            <span class="post-title" title="Deep Learning Course3 Week1 Programming Assignment1">Deep Learning Course3 Week1 Programming Assignment1</span>
            <span class="post-date" title="2018-08-15 00:00:00">2018/08/15</span>
        </a>
        
    </nav>
</div>
    </div>
    <div class="hide-list">
        <div class="semicircle">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div class="post">
    <div class="pjax">
        <article id="post-2018-08-15-Convolution+model+-+Application+-+v1" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">Deep Learning Course3 Week1 Programming Assignment2</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            
                <a href="javascript:" data-rel="Machine Learning">Machine Learning</a>
            
        </span>
        
        
        <span class="tag">
            
            <a href="javascript:" class="color1">Tensorflow</a>
            
            <a href="javascript:" class="color2">Machine Learning</a>
            
            <a href="javascript:" class="color4">Deep Learning</a>
            
            <a href="javascript:" class="color4">Convolutional Neural Network</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
        创建时间:<time class="date" title='更新时间: 2018-08-20 09:34:26'>2018-08-16 00:00</time>
        
    </div>
    <div class="article-meta">
        
        
        <span id="busuanzi_container_page_pv">
            阅读:<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Convolutional-Neural-Networks-Application"><span class="toc-text">Convolutional Neural Networks: Application</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-0-TensorFlow-model"><span class="toc-text">1.0 - TensorFlow model</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-Create-placeholders"><span class="toc-text">1.1 - Create placeholders</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-Initialize-parameters"><span class="toc-text">1.2 - Initialize parameters</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-Forward-propagation"><span class="toc-text">1.2 - Forward propagation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-Compute-cost"><span class="toc-text">1.3 - Compute cost</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-Model"><span class="toc-text">1.4 Model</span></a></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Convolutional-Neural-Networks-Application"><a href="#Convolutional-Neural-Networks-Application" class="headerlink" title="Convolutional Neural Networks: Application"></a>Convolutional Neural Networks: Application</h1><p>Welcome to Course 4’s second assignment! In this notebook, you will:</p>
<ul>
<li>Implement helper functions that you will use when implementing a TensorFlow model</li>
<li>Implement a fully functioning ConvNet using TensorFlow </li>
</ul>
<p><strong>After this assignment you will be able to:</strong></p>
<ul>
<li>Build and train a ConvNet in TensorFlow for a classification problem </li>
</ul>
<p>We assume here that you are already familiar with TensorFlow. If you are not, please refer the <em>TensorFlow Tutorial</em> of the third week of Course 2 (“<em>Improving deep neural networks</em>“).</p>
<h2 id="1-0-TensorFlow-model"><a href="#1-0-TensorFlow-model" class="headerlink" title="1.0 - TensorFlow model"></a>1.0 - TensorFlow model</h2><p>In the previous assignment, you built helper functions using numpy to understand the mechanics behind convolutional neural networks. Most practical applications of deep learning today are built using programming frameworks, which have many built-in functions you can simply call. </p>
<p>As usual, we will start by loading in the packages. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> h5py</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> scipy</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> ndimage</span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> tensorflow.python.framework <span class="keyword">import</span> ops</span><br><span class="line"><span class="keyword">from</span> cnn_utils <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">%matplotlib inline</span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>Run the next cell to load the “SIGNS” dataset you are going to use.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Loading the data (signs)</span></span><br><span class="line">X_train_orig, Y_train_orig, X_test_orig, Y_test_orig, classes = load_dataset()</span><br></pre></td></tr></table></figure>
<p>As a reminder, the SIGNS dataset is a collection of 6 signs representing numbers from 0 to 5.</p>
<p><img src="http://pd57dw586.bkt.clouddn.com/SIGNS.png" style="width:800px;height:300px;"></p>
<p>The next cell will show you an example of a labelled image in the dataset. Feel free to change the value of <code>index</code> below and re-run to see different examples. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Example of a picture</span></span><br><span class="line">index = <span class="number">6</span></span><br><span class="line">plt.imshow(X_train_orig[index])</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"y = "</span> + str(np.squeeze(Y_train_orig[:, index])))</span><br></pre></td></tr></table></figure>
<pre><code>y = 2
</code></pre><p><img src="output_6_1.png" alt="png"></p>
<p>In Course 2, you had built a fully-connected network for this dataset. But since this is an image dataset, it is more natural to apply a ConvNet to it.</p>
<p>To get started, let’s examine the shapes of your data. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">X_train = X_train_orig/<span class="number">255.</span></span><br><span class="line">X_test = X_test_orig/<span class="number">255.</span></span><br><span class="line">Y_train = convert_to_one_hot(Y_train_orig, <span class="number">6</span>).T</span><br><span class="line">Y_test = convert_to_one_hot(Y_test_orig, <span class="number">6</span>).T</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"number of training examples = "</span> + str(X_train.shape[<span class="number">0</span>]))</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"number of test examples = "</span> + str(X_test.shape[<span class="number">0</span>]))</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"X_train shape: "</span> + str(X_train.shape))</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"Y_train shape: "</span> + str(Y_train.shape))</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"X_test shape: "</span> + str(X_test.shape))</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"Y_test shape: "</span> + str(Y_test.shape))</span><br><span class="line">conv_layers = &#123;&#125;</span><br></pre></td></tr></table></figure>
<pre><code>number of training examples = 1080
number of test examples = 120
X_train shape: (1080, 64, 64, 3)
Y_train shape: (1080, 6)
X_test shape: (120, 64, 64, 3)
Y_test shape: (120, 6)
</code></pre><h3 id="1-1-Create-placeholders"><a href="#1-1-Create-placeholders" class="headerlink" title="1.1 - Create placeholders"></a>1.1 - Create placeholders</h3><p>TensorFlow requires that you create placeholders for the input data that will be fed into the model when running the session.</p>
<p><strong>Exercise</strong>: Implement the function below to create placeholders for the input image X and the output Y. You should not define the number of training examples for the moment. To do so, you could use “None” as the batch size, it will give you the flexibility to choose it later. Hence X should be of dimension <strong>[None, n_H0, n_W0, n_C0]</strong> and Y should be of dimension <strong>[None, n_y]</strong>.  <a href="https://www.tensorflow.org/api_docs/python/tf/placeholder" target="_blank" rel="noopener">Hint</a>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># GRADED FUNCTION: create_placeholders</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_placeholders</span><span class="params">(n_H0, n_W0, n_C0, n_y)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Creates the placeholders for the tensorflow session.</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Arguments:</span></span><br><span class="line"><span class="string">    n_H0 -- scalar, height of an input image</span></span><br><span class="line"><span class="string">    n_W0 -- scalar, width of an input image</span></span><br><span class="line"><span class="string">    n_C0 -- scalar, number of channels of the input</span></span><br><span class="line"><span class="string">    n_y -- scalar, number of classes</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">    X -- placeholder for the data input, of shape [None, n_H0, n_W0, n_C0] and dtype "float"</span></span><br><span class="line"><span class="string">    Y -- placeholder for the input labels, of shape [None, n_y] and dtype "float"</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">### START CODE HERE ### (≈2 lines)</span></span><br><span class="line">    X = tf.placeholder(dtype=tf.float32, shape=(<span class="keyword">None</span>, n_H0, n_W0, n_C0))</span><br><span class="line">    Y = tf.placeholder(dtype=tf.float32, shape=(<span class="keyword">None</span>, n_y))</span><br><span class="line">    <span class="comment">### END CODE HERE ###</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> X, Y</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">X, Y = create_placeholders(<span class="number">64</span>, <span class="number">64</span>, <span class="number">3</span>, <span class="number">6</span>)</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"X = "</span> + str(X))</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"Y = "</span> + str(Y))</span><br></pre></td></tr></table></figure>
<pre><code>X = Tensor(&quot;Placeholder:0&quot;, shape=(?, 64, 64, 3), dtype=float32)
Y = Tensor(&quot;Placeholder_1:0&quot;, shape=(?, 6), dtype=float32)
</code></pre><p><strong>Expected Output</strong></p>
<table><br><tr><br><td><br>    X = Tensor(“Placeholder:0”, shape=(?, 64, 64, 3), dtype=float32)<br><br></td><br></tr><br><tr><br><td><br>    Y = Tensor(“Placeholder_1:0”, shape=(?, 6), dtype=float32)<br><br></td><br></tr><br></table>

<h3 id="1-2-Initialize-parameters"><a href="#1-2-Initialize-parameters" class="headerlink" title="1.2 - Initialize parameters"></a>1.2 - Initialize parameters</h3><p>You will initialize weights/filters $W1$ and $W2$ using <code>tf.contrib.layers.xavier_initializer(seed = 0)</code>. You don’t need to worry about bias variables as you will soon see that TensorFlow functions take care of the bias. Note also that you will only initialize the weights/filters for the conv2d functions. TensorFlow initializes the layers for the fully connected part automatically. We will talk more about that later in this assignment.</p>
<p><strong>Exercise:</strong> Implement initialize_parameters(). The dimensions for each group of filters are provided below. Reminder - to initialize a parameter $W$ of shape [1,2,3,4] in Tensorflow, use:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">W = tf.get_variable(<span class="string">"W"</span>, [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>], initializer = ...)</span><br></pre></td></tr></table></figure></p>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/get_variable" target="_blank" rel="noopener">More Info</a>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># GRADED FUNCTION: initialize_parameters</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">initialize_parameters</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Initializes weight parameters to build a neural network with tensorflow. The shapes are:</span></span><br><span class="line"><span class="string">                        W1 : [4, 4, 3, 8]</span></span><br><span class="line"><span class="string">                        W2 : [2, 2, 8, 16]</span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">    parameters -- a dictionary of tensors containing W1, W2</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    </span><br><span class="line">    tf.set_random_seed(<span class="number">1</span>)                              <span class="comment"># so that your "random" numbers match ours</span></span><br><span class="line">        </span><br><span class="line">    <span class="comment">### START CODE HERE ### (approx. 2 lines of code)</span></span><br><span class="line">    W1 = tf.get_variable(<span class="string">'W1'</span>, [<span class="number">4</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">8</span>], initializer = tf.contrib.layers.xavier_initializer(seed = <span class="number">0</span>))</span><br><span class="line">    W2 = tf.get_variable(<span class="string">'W2'</span>, [<span class="number">2</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">16</span>], initializer= tf.contrib.layers.xavier_initializer(seed = <span class="number">0</span>))</span><br><span class="line">    <span class="comment">### END CODE HERE ###</span></span><br><span class="line"></span><br><span class="line">    parameters = &#123;<span class="string">"W1"</span>: W1,</span><br><span class="line">                  <span class="string">"W2"</span>: W2&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> parameters</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tf.reset_default_graph()</span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess_test:</span><br><span class="line">    parameters = initialize_parameters()</span><br><span class="line">    init = tf.global_variables_initializer()</span><br><span class="line">    sess_test.run(init)</span><br><span class="line">    print(<span class="string">"W1 = "</span> + str(parameters[<span class="string">"W1"</span>].eval()[<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>]))</span><br><span class="line">    print(<span class="string">"W2 = "</span> + str(parameters[<span class="string">"W2"</span>].eval()[<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>]))</span><br></pre></td></tr></table></figure>
<pre><code>W1 = [ 0.00131723  0.14176141 -0.04434952  0.09197326  0.14984085 -0.03514394
 -0.06847463  0.05245192]
W2 = [-0.08566415  0.17750949  0.11974221  0.16773748 -0.0830943  -0.08058
 -0.00577033 -0.14643836  0.24162132 -0.05857408 -0.19055021  0.1345228
 -0.22779644 -0.1601823  -0.16117483 -0.10286498]
</code></pre><p><strong> Expected Output:</strong></p>
<table><br><br>    <tr><br>        <td><br>        W1 =<br>        </td><br>        <td><br>[ 0.00131723  0.14176141 -0.04434952  0.09197326  0.14984085 -0.03514394 <br><br> -0.06847463  0.05245192]<br>        </td><br>    </tr><br><br>    <tr><br>        <td><br>        W2 =<br>        </td><br>        <td><br>[-0.08566415  0.17750949  0.11974221  0.16773748 -0.0830943  -0.08058 <br><br> -0.00577033 -0.14643836  0.24162132 -0.05857408 -0.19055021  0.1345228 <br><br> -0.22779644 -0.1601823  -0.16117483 -0.10286498]<br>        </td><br>    </tr><br><br></table>

<h3 id="1-2-Forward-propagation"><a href="#1-2-Forward-propagation" class="headerlink" title="1.2 - Forward propagation"></a>1.2 - Forward propagation</h3><p>In TensorFlow, there are built-in functions that carry out the convolution steps for you.</p>
<ul>
<li><p><strong>tf.nn.conv2d(X,W1, strides = [1,s,s,1], padding = ‘SAME’):</strong> given an input $X$ and a group of filters $W1$, this function convolves $W1$’s filters on X. The third input ([1,f,f,1]) represents the strides for each dimension of the input (m, n_H_prev, n_W_prev, n_C_prev). You can read the full documentation <a href="https://www.tensorflow.org/api_docs/python/tf/nn/conv2d" target="_blank" rel="noopener">here</a></p>
</li>
<li><p><strong>tf.nn.max_pool(A, ksize = [1,f,f,1], strides = [1,s,s,1], padding = ‘SAME’):</strong> given an input A, this function uses a window of size (f, f) and strides of size (s, s) to carry out max pooling over each window. You can read the full documentation <a href="https://www.tensorflow.org/api_docs/python/tf/nn/max_pool" target="_blank" rel="noopener">here</a></p>
</li>
<li><p><strong>tf.nn.relu(Z1):</strong> computes the elementwise ReLU of Z1 (which can be any shape). You can read the full documentation <a href="https://www.tensorflow.org/api_docs/python/tf/nn/relu" target="_blank" rel="noopener">here.</a></p>
</li>
<li><p><strong>tf.contrib.layers.flatten(P)</strong>: given an input P, this function flattens each example into a 1D vector it while maintaining the batch-size. It returns a flattened tensor with shape [batch_size, k]. You can read the full documentation <a href="https://www.tensorflow.org/api_docs/python/tf/contrib/layers/flatten" target="_blank" rel="noopener">here.</a></p>
</li>
<li><p><strong>tf.contrib.layers.fully_connected(F, num_outputs):</strong> given a the flattened input F, it returns the output computed using a fully connected layer. You can read the full documentation <a href="https://www.tensorflow.org/api_docs/python/tf/contrib/layers/fully_connected" target="_blank" rel="noopener">here.</a></p>
</li>
</ul>
<p>In the last function above (<code>tf.contrib.layers.fully_connected</code>), the fully connected layer automatically initializes weights in the graph and keeps on training them as you train the model. Hence, you did not need to initialize those weights when initializing the parameters. </p>
<p><strong>Exercise</strong>: </p>
<p>Implement the <code>forward_propagation</code> function below to build the following model: <code>CONV2D -&gt; RELU -&gt; MAXPOOL -&gt; CONV2D -&gt; RELU -&gt; MAXPOOL -&gt; FLATTEN -&gt; FULLYCONNECTED</code>. You should use the functions above. </p>
<p>In detail, we will use the following parameters for all the steps:</p>
<pre><code>- Conv2D: stride 1, padding is &quot;SAME&quot;
- ReLU
- Max pool: Use an 8 by 8 filter size and an 8 by 8 stride, padding is &quot;SAME&quot;
- Conv2D: stride 1, padding is &quot;SAME&quot;
- ReLU
- Max pool: Use a 4 by 4 filter size and a 4 by 4 stride, padding is &quot;SAME&quot;
- Flatten the previous output.
- FULLYCONNECTED (FC) layer: Apply a fully connected layer without an non-linear activation function. Do not call the softmax here. This will result in 6 neurons in the output layer, which then get passed later to a softmax. In TensorFlow, the softmax and cost function are lumped together into a single function, which you&apos;ll call in a different function when computing the cost. 
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># GRADED FUNCTION: forward_propagation</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">forward_propagation</span><span class="params">(X, parameters)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Implements the forward propagation for the model:</span></span><br><span class="line"><span class="string">    CONV2D -&gt; RELU -&gt; MAXPOOL -&gt; CONV2D -&gt; RELU -&gt; MAXPOOL -&gt; FLATTEN -&gt; FULLYCONNECTED</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Arguments:</span></span><br><span class="line"><span class="string">    X -- input dataset placeholder, of shape (input size, number of examples)</span></span><br><span class="line"><span class="string">    parameters -- python dictionary containing your parameters "W1", "W2"</span></span><br><span class="line"><span class="string">                  the shapes are given in initialize_parameters</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">    Z3 -- the output of the last LINEAR unit</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Retrieve the parameters from the dictionary "parameters" </span></span><br><span class="line">    W1 = parameters[<span class="string">'W1'</span>]</span><br><span class="line">    W2 = parameters[<span class="string">'W2'</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment">### START CODE HERE ###</span></span><br><span class="line">    <span class="comment"># CONV2D: stride of 1, padding 'SAME'</span></span><br><span class="line">    Z1 = tf.nn.conv2d(input=X, filter=W1, strides=[<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>], padding=<span class="string">'SAME'</span>)</span><br><span class="line">    <span class="comment"># RELU</span></span><br><span class="line">    A1 = tf.nn.relu(Z1)</span><br><span class="line">    <span class="comment"># MAXPOOL: window 8x8, stride 8, padding 'SAME'</span></span><br><span class="line">    P1 = tf.nn.max_pool(value=A1, ksize=[<span class="number">1</span>,<span class="number">8</span>,<span class="number">8</span>,<span class="number">1</span>], strides=[<span class="number">1</span>,<span class="number">8</span>,<span class="number">8</span>,<span class="number">1</span>], padding=<span class="string">'SAME'</span>)</span><br><span class="line">    <span class="comment"># CONV2D: filters W2, stride 1, padding 'SAME'</span></span><br><span class="line">    Z2 = tf.nn.conv2d(input=P1, filter=W2, strides=[<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>], padding=<span class="string">'SAME'</span>)</span><br><span class="line">    <span class="comment"># RELU</span></span><br><span class="line">    A2 = tf.nn.relu(Z2)</span><br><span class="line">    <span class="comment"># MAXPOOL: window 4x4, stride 4, padding 'SAME'</span></span><br><span class="line">    P2 = tf.nn.max_pool(value=A2, ksize=[<span class="number">1</span>,<span class="number">4</span>,<span class="number">4</span>,<span class="number">1</span>], strides=[<span class="number">1</span>,<span class="number">4</span>,<span class="number">4</span>,<span class="number">1</span>], padding=<span class="string">'SAME'</span>)</span><br><span class="line">    <span class="comment"># FLATTEN</span></span><br><span class="line">    P2 = tf.contrib.layers.flatten(P2)</span><br><span class="line">    <span class="comment"># FULLY-CONNECTED without non-linear activation function (not not call softmax).</span></span><br><span class="line">    <span class="comment"># 6 neurons in output layer. Hint: one of the arguments should be "activation_fn=None" </span></span><br><span class="line">    Z3 = tf.contrib.layers.fully_connected(P2, activation_fn=<span class="keyword">None</span>, num_outputs=<span class="number">6</span>)</span><br><span class="line">    <span class="comment">### END CODE HERE ###</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Z3</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">tf.reset_default_graph()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">    np.random.seed(<span class="number">1</span>)</span><br><span class="line">    X, Y = create_placeholders(<span class="number">64</span>, <span class="number">64</span>, <span class="number">3</span>, <span class="number">6</span>)</span><br><span class="line">    parameters = initialize_parameters()</span><br><span class="line">    Z3 = forward_propagation(X, parameters)</span><br><span class="line">    init = tf.global_variables_initializer()</span><br><span class="line">    sess.run(init)</span><br><span class="line">    a = sess.run(Z3, &#123;X: np.random.randn(<span class="number">2</span>,<span class="number">64</span>,<span class="number">64</span>,<span class="number">3</span>), Y: np.random.randn(<span class="number">2</span>,<span class="number">6</span>)&#125;)</span><br><span class="line">    print(<span class="string">"Z3 = "</span> + str(a))</span><br></pre></td></tr></table></figure>
<pre><code>Z3 = [[-0.44670227 -1.57208765 -1.53049231 -2.31013036 -1.29104376  0.46852064]
 [-0.17601591 -1.57972014 -1.4737016  -2.61672091 -1.00810647  0.5747785 ]]
</code></pre><p><strong>Expected Output</strong>:</p>
<table><br>    <td><br>    Z3 =<br>    </td><br>    <td><br>    [[-0.44670227 -1.57208765 -1.53049231 -2.31013036 -1.29104376  0.46852064] <br><br> [-0.17601591 -1.57972014 -1.4737016  -2.61672091 -1.00810647  0.5747785 ]]<br>    </td><br></table>

<h3 id="1-3-Compute-cost"><a href="#1-3-Compute-cost" class="headerlink" title="1.3 - Compute cost"></a>1.3 - Compute cost</h3><p>Implement the compute cost function below. You might find these two functions helpful: </p>
<ul>
<li><strong>tf.nn.softmax_cross_entropy_with_logits(logits = Z3, labels = Y):</strong> computes the softmax entropy loss. This function both computes the softmax activation function as well as the resulting loss. You can check the full documentation  <a href="https://www.tensorflow.org/api_docs/python/tf/nn/softmax_cross_entropy_with_logits" target="_blank" rel="noopener">here.</a></li>
<li><strong>tf.reduce_mean:</strong> computes the mean of elements across dimensions of a tensor. Use this to sum the losses over all the examples to get the overall cost. You can check the full documentation <a href="https://www.tensorflow.org/api_docs/python/tf/reduce_mean" target="_blank" rel="noopener">here.</a></li>
</ul>
<p><strong> Exercise</strong>: Compute the cost below using the function above.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># GRADED FUNCTION: compute_cost </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compute_cost</span><span class="params">(Z3, Y)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Computes the cost</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Arguments:</span></span><br><span class="line"><span class="string">    Z3 -- output of forward propagation (output of the last LINEAR unit), of shape (6, number of examples)</span></span><br><span class="line"><span class="string">    Y -- "true" labels vector placeholder, same shape as Z3</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">    cost - Tensor of the cost function</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">### START CODE HERE ### (1 line of code)</span></span><br><span class="line">    cost = tf.reduce_mean(tf.nn.softmax_cross_entropy_with_logits(logits=Z3, labels=Y))</span><br><span class="line">    <span class="comment">### END CODE HERE ###</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> cost</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">tf.reset_default_graph()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">    np.random.seed(<span class="number">1</span>)</span><br><span class="line">    X, Y = create_placeholders(<span class="number">64</span>, <span class="number">64</span>, <span class="number">3</span>, <span class="number">6</span>)</span><br><span class="line">    parameters = initialize_parameters()</span><br><span class="line">    Z3 = forward_propagation(X, parameters)</span><br><span class="line">    cost = compute_cost(Z3, Y)</span><br><span class="line">    init = tf.global_variables_initializer()</span><br><span class="line">    sess.run(init)</span><br><span class="line">    a = sess.run(cost, &#123;X: np.random.randn(<span class="number">4</span>,<span class="number">64</span>,<span class="number">64</span>,<span class="number">3</span>), Y: np.random.randn(<span class="number">4</span>,<span class="number">6</span>)&#125;)</span><br><span class="line">    print(<span class="string">"cost = "</span> + str(a))</span><br></pre></td></tr></table></figure>
<pre><code>cost = 2.91034
</code></pre><p><strong>Expected Output</strong>: </p>
<table><br>    <td><br>    cost =<br>    </td><br><br>    <td><br>    2.91034<br>    </td><br></table>

<h2 id="1-4-Model"><a href="#1-4-Model" class="headerlink" title="1.4 Model"></a>1.4 Model</h2><p>Finally you will merge the helper functions you implemented above to build a model. You will train it on the SIGNS dataset. </p>
<p>You have implemented <code>random_mini_batches()</code> in the Optimization programming assignment of course 2. Remember that this function returns a list of mini-batches. </p>
<p><strong>Exercise</strong>: Complete the function below. </p>
<p>The model below should:</p>
<ul>
<li>create placeholders</li>
<li>initialize parameters</li>
<li>forward propagate</li>
<li>compute the cost</li>
<li>create an optimizer</li>
</ul>
<p>Finally you will create a session and run a for loop  for num_epochs, get the mini-batches, and then for each mini-batch you will optimize the function. <a href="https://www.tensorflow.org/api_docs/python/tf/global_variables_initializer" target="_blank" rel="noopener">Hint for initializing the variables</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># GRADED FUNCTION: model</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">model</span><span class="params">(X_train, Y_train, X_test, Y_test, learning_rate = <span class="number">0.009</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">          num_epochs = <span class="number">100</span>, minibatch_size = <span class="number">64</span>, print_cost = True)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Implements a three-layer ConvNet in Tensorflow:</span></span><br><span class="line"><span class="string">    CONV2D -&gt; RELU -&gt; MAXPOOL -&gt; CONV2D -&gt; RELU -&gt; MAXPOOL -&gt; FLATTEN -&gt; FULLYCONNECTED</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Arguments:</span></span><br><span class="line"><span class="string">    X_train -- training set, of shape (None, 64, 64, 3)</span></span><br><span class="line"><span class="string">    Y_train -- test set, of shape (None, n_y = 6)</span></span><br><span class="line"><span class="string">    X_test -- training set, of shape (None, 64, 64, 3)</span></span><br><span class="line"><span class="string">    Y_test -- test set, of shape (None, n_y = 6)</span></span><br><span class="line"><span class="string">    learning_rate -- learning rate of the optimization</span></span><br><span class="line"><span class="string">    num_epochs -- number of epochs of the optimization loop</span></span><br><span class="line"><span class="string">    minibatch_size -- size of a minibatch</span></span><br><span class="line"><span class="string">    print_cost -- True to print the cost every 100 epochs</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">    train_accuracy -- real number, accuracy on the train set (X_train)</span></span><br><span class="line"><span class="string">    test_accuracy -- real number, testing accuracy on the test set (X_test)</span></span><br><span class="line"><span class="string">    parameters -- parameters learnt by the model. They can then be used to predict.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    </span><br><span class="line">    ops.reset_default_graph()                         <span class="comment"># to be able to rerun the model without overwriting tf variables</span></span><br><span class="line">    tf.set_random_seed(<span class="number">1</span>)                             <span class="comment"># to keep results consistent (tensorflow seed)</span></span><br><span class="line">    seed = <span class="number">3</span>                                          <span class="comment"># to keep results consistent (numpy seed)</span></span><br><span class="line">    (m, n_H0, n_W0, n_C0) = X_train.shape             </span><br><span class="line">    n_y = Y_train.shape[<span class="number">1</span>]                            </span><br><span class="line">    costs = []                                        <span class="comment"># To keep track of the cost</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Create Placeholders of the correct shape</span></span><br><span class="line">    <span class="comment">### START CODE HERE ### (1 line)</span></span><br><span class="line">    X, Y = create_placeholders(n_H0, n_W0, n_C0, n_y)</span><br><span class="line">    <span class="comment">### END CODE HERE ###</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Initialize parameters</span></span><br><span class="line">    <span class="comment">### START CODE HERE ### (1 line)</span></span><br><span class="line">    parameters = initialize_parameters()</span><br><span class="line">    <span class="comment">### END CODE HERE ###</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Forward propagation: Build the forward propagation in the tensorflow graph</span></span><br><span class="line">    <span class="comment">### START CODE HERE ### (1 line)</span></span><br><span class="line">    Z3 = forward_propagation(X, parameters)</span><br><span class="line">    <span class="comment">### END CODE HERE ###</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Cost function: Add cost function to tensorflow graph</span></span><br><span class="line">    <span class="comment">### START CODE HERE ### (1 line)</span></span><br><span class="line">    cost = compute_cost(Z3, Y)</span><br><span class="line">    <span class="comment">### END CODE HERE ###</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Backpropagation: Define the tensorflow optimizer. Use an AdamOptimizer that minimizes the cost.</span></span><br><span class="line">    <span class="comment">### START CODE HERE ### (1 line)</span></span><br><span class="line">    optimizer = tf.train.AdamOptimizer(learning_rate).minimize(cost)</span><br><span class="line">    <span class="comment">### END CODE HERE ###</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Initialize all the variables globally</span></span><br><span class="line">    init = tf.global_variables_initializer()</span><br><span class="line">     </span><br><span class="line">    <span class="comment"># Start the session to compute the tensorflow graph</span></span><br><span class="line">    <span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Run the initialization</span></span><br><span class="line">        sess.run(init)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Do the training loop</span></span><br><span class="line">        <span class="keyword">for</span> epoch <span class="keyword">in</span> range(num_epochs):</span><br><span class="line"></span><br><span class="line">            minibatch_cost = <span class="number">0.</span></span><br><span class="line">            num_minibatches = int(m / minibatch_size) <span class="comment"># number of minibatches of size minibatch_size in the train set</span></span><br><span class="line">            seed = seed + <span class="number">1</span></span><br><span class="line">            minibatches = random_mini_batches(X_train, Y_train, minibatch_size, seed)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> minibatch <span class="keyword">in</span> minibatches:</span><br><span class="line"></span><br><span class="line">                <span class="comment"># Select a minibatch</span></span><br><span class="line">                (minibatch_X, minibatch_Y) = minibatch</span><br><span class="line">                <span class="comment"># IMPORTANT: The line that runs the graph on a minibatch.</span></span><br><span class="line">                <span class="comment"># Run the session to execute the optimizer and the cost, the feedict should contain a minibatch for (X,Y).</span></span><br><span class="line">                <span class="comment">### START CODE HERE ### (1 line)</span></span><br><span class="line">                _ , temp_cost = sess.run([optimizer, cost], feed_dict=&#123;X:minibatch_X, Y:minibatch_Y&#125;)</span><br><span class="line">                <span class="comment">### END CODE HERE ###</span></span><br><span class="line">                </span><br><span class="line">                minibatch_cost += temp_cost / num_minibatches</span><br><span class="line">                </span><br><span class="line"></span><br><span class="line">            <span class="comment"># Print the cost every epoch</span></span><br><span class="line">            <span class="keyword">if</span> print_cost == <span class="keyword">True</span> <span class="keyword">and</span> epoch % <span class="number">5</span> == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">print</span> (<span class="string">"Cost after epoch %i: %f"</span> % (epoch, minibatch_cost))</span><br><span class="line">            <span class="keyword">if</span> print_cost == <span class="keyword">True</span> <span class="keyword">and</span> epoch % <span class="number">1</span> == <span class="number">0</span>:</span><br><span class="line">                costs.append(minibatch_cost)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="comment"># plot the cost</span></span><br><span class="line">        plt.plot(np.squeeze(costs))</span><br><span class="line">        plt.ylabel(<span class="string">'cost'</span>)</span><br><span class="line">        plt.xlabel(<span class="string">'iterations (per tens)'</span>)</span><br><span class="line">        plt.title(<span class="string">"Learning rate ="</span> + str(learning_rate))</span><br><span class="line">        plt.show()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Calculate the correct predictions</span></span><br><span class="line">        predict_op = tf.argmax(Z3, <span class="number">1</span>)</span><br><span class="line">        correct_prediction = tf.equal(predict_op, tf.argmax(Y, <span class="number">1</span>))</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Calculate accuracy on the test set</span></span><br><span class="line">        accuracy = tf.reduce_mean(tf.cast(correct_prediction, <span class="string">"float"</span>))</span><br><span class="line">        print(accuracy)</span><br><span class="line">        train_accuracy = accuracy.eval(&#123;X: X_train, Y: Y_train&#125;)</span><br><span class="line">        test_accuracy = accuracy.eval(&#123;X: X_test, Y: Y_test&#125;)</span><br><span class="line">        print(<span class="string">"Train Accuracy:"</span>, train_accuracy)</span><br><span class="line">        print(<span class="string">"Test Accuracy:"</span>, test_accuracy)</span><br><span class="line">                </span><br><span class="line">        <span class="keyword">return</span> train_accuracy, test_accuracy, parameters</span><br></pre></td></tr></table></figure>
<p>Run the following cell to train your model for 100 epochs. Check if your cost after epoch 0 and 5 matches our output. If not, stop the cell and go back to your code!</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_, _, parameters = model(X_train, Y_train, X_test, Y_test)</span><br></pre></td></tr></table></figure>
<pre><code>Cost after epoch 0: 1.917929
Cost after epoch 5: 1.506757
Cost after epoch 10: 0.955359
Cost after epoch 15: 0.845802
Cost after epoch 20: 0.701174
Cost after epoch 25: 0.571977
Cost after epoch 30: 0.518435
Cost after epoch 35: 0.495806
Cost after epoch 40: 0.429827
Cost after epoch 45: 0.407291
Cost after epoch 50: 0.366394
Cost after epoch 55: 0.376922
Cost after epoch 60: 0.299491
Cost after epoch 65: 0.338870
Cost after epoch 70: 0.316400
Cost after epoch 75: 0.310413
Cost after epoch 80: 0.249549
Cost after epoch 85: 0.243457
Cost after epoch 90: 0.200031
Cost after epoch 95: 0.175452
</code></pre><p><img src="output_28_1.png" alt="png"></p>
<pre><code>Tensor(&quot;Mean_1:0&quot;, shape=(), dtype=float32)
Train Accuracy: 0.940741
Test Accuracy: 0.783333
</code></pre><p><strong>Expected output</strong>: although it may not match perfectly, your expected output should be close to ours and your cost value should decrease.</p>
<table><br><tr><br>    <td><br>    <strong>Cost after epoch 0 =</strong><br>    </td><br><br>    <td><br>      1.917929<br>    </td><br></tr><br><tr><br>    <td><br>    <strong>Cost after epoch 5 =</strong><br>    </td><br><br>    <td><br>      1.506757<br>    </td><br></tr><br><tr><br>    <td><br>    <strong>Train Accuracy   =</strong><br>    </td><br><br>    <td><br>      0.940741<br>    </td><br></tr><br><br><tr><br>    <td><br>    <strong>Test Accuracy   =</strong><br>    </td><br><br>    <td><br>      0.783333<br>    </td><br></tr><br></table>

<p>Congratulations! You have finised the assignment and built a model that recognizes SIGN language with almost 80% accuracy on the test set. If you wish, feel free to play around with this dataset further. You can actually improve its accuracy by spending more time tuning the hyperparameters, or using regularization (as this model clearly has a high variance). </p>
<p>Once again, here’s a thumbs up for your work! </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fname = <span class="string">"images/thumbs_up.jpg"</span></span><br><span class="line">image = np.array(ndimage.imread(fname, flatten=<span class="keyword">False</span>))</span><br><span class="line">my_image = scipy.misc.imresize(image, size=(<span class="number">64</span>,<span class="number">64</span>))</span><br><span class="line">plt.imshow(my_image)</span><br></pre></td></tr></table></figure>

      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。可以在下面评论区评论，也可以邮件至 jaytp@qq.com </span>
    </div>
</article>


<p>
    <a href="javascript:void(0)" class="dashang" onclick="dashangToggle()">赏</a>
</p>


<div class="article_copyright">
    <p><span class="copy-title">文章标题:</span>Deep Learning Course3 Week1 Programming Assignment2</p>
    
    <p><span class="copy-title">本文作者:</span><a href="javascript:void(0)" title="Jin Wang">Jin Wang</a></p>
    <p><span class="copy-title">发布时间:</span>2018-08-16, 00:00:00</p>
    <p><span class="copy-title">最后更新:</span>2018-08-20, 09:34:26</p>
    <span class="copy-title">原始链接:</span><a class="post-url" href="/2018/08/16/2018-08-15-Convolution+model+-+Application+-+v1/" title="Deep Learning Course3 Week1 Programming Assignment2">http://www.jinwang.world/2018/08/16/2018-08-15-Convolution+model+-+Application+-+v1/</a>
    <p>
        <span class="copy-title">版权声明:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
    </p>
</div>





    
        <!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
    });
</script>
<!-- 给MathJax元素添加has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- 通过连接CDN加载MathJax的js代码 -->
<script type="text/javascript" async
        src="//cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<input type="hidden" id="MathJax-js"
        value="//cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</input>
    




    </div>
    <div class="copyright">
        <p class="footer-entry">©2016-2019 Yelog</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full"><span class="min "></span></button>
<button class="post-toc-menu"><span class="post-toc-menu-icons"></span></button>
<div class="post-toc"><span class="post-toc-title">目录</span>
    <div class="post-toc-content">

    </div>
</div>
<a class="" id="rocket" href="javascript:void(0)"></a>
    </div>
</div>
<div class="acParent"></div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close" href="javascript:void(0)" onclick="dashangToggle()">×</a>
    <div class="shang_tit">
        <p>喜欢就点赞,疼爱就打赏</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="扫码支持">
            <img src="/img/weixin.jpg" class="weixin" title="扫码支持">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">支付宝</label></span><span><label><input type="radio" name="pay" value="weixin">微信</label></span>
    </div>
</div>


</body>
<script src="/js/jquery.pjax.js?v=1.0.1" ></script>

<script src="/js/script.js?v=1.0.1" ></script>
<script>
    var img_resize = 'default';
    /*作者、标签的自动补全*/
    $(function () {
        $('.search').AutoComplete({
            'data': ['#Python','#Stanford','#Tensorflow','#DSP','#Matlab','#Communication System','#Random Process','#Digital Image Processing','#Pandas','#Digital Signal Processing','#DTFT','#Json','#csv','#爬虫','#API','#Nodejs','#Web Development','#Dynamic Programming','#Leetcode','#Binary Tree','#Queue','#BinaryTree','#Recursion','#Iteration','#Binary Search','#Keras','#Machine Learning','#GRE','#GRE Issue','#Deep Learning','#Convolutional Neural Network','#WebDevelopment',],
            'itemHeight': 20,
            'width': 418
        }).AutoComplete('show');
    })
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $(".post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*高亮代码块行号*/
        
        $('pre code').each(function(){
            var lines = $(this).text().split('\n').length - 1, widther='';
            if (lines>99) {
                widther = 'widther'
            }
            var $numbering = $('<ul/>').addClass('pre-numbering ' + widther).attr("unselectable","on");
            $(this).addClass('has-numbering ' + widther)
                    .parent()
                    .append($numbering);
            for(var i=1;i<=lines;i++){
                $numbering.append($('<li/>').text(i));
            }
        });
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
    }

    /*打赏页面隐藏与展示*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--加入行号的高亮代码块样式-->

<style>
    pre{
        position: relative;
        margin-bottom: 24px;
        border-radius: 10px;
        border: 1px solid #e2dede;
        background: #FFF;
        overflow: hidden;
    }
    code.has-numbering{
        margin-left: 30px;
    }
    code.has-numbering.widther{
        margin-left: 35px;
    }
    .pre-numbering{
        margin: 0px;
        position: absolute;
        top: 0;
        left: 0;
        width: 20px;
        padding: 0.5em 3px 0.7em 5px;
        border-right: 1px solid #C3CCD0;
        text-align: right;
        color: #AAA;
        background-color: #fafafa;
    }
    .pre-numbering.widther {
        width: 35px;
    }
</style>

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
        .nav .hide-list.fullscreen {
            left: 492px
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    
    .post .pjax article .article-entry>ol, .post .pjax article .article-entry>ul, .post .pjax article>ol, .post .pjax article>ul{
        border: #e2dede solid 1px;
        border-radius: 10px;
        padding: 10px 32px 10px 56px;
    }
    .post .pjax article .article-entry li>ol, .post .pjax article .article-entry li>ul,.post .pjax article li>ol, .post .pjax article li>ul{
        padding-top: 5px;
        padding-bottom: 5px;
    }
    .post .pjax article .article-entry>ol>li, .post .pjax article .article-entry>ul>li,.post .pjax article>ol>li, .post .pjax article>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    .post .pjax article .article-entry li>ol>li, .post .pjax article .article-entry li>ul>li,.post .pjax article li>ol>li, .post .pjax article li>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    
    .nav-right:before {
        content: ' ';
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        opacity: 0.3;
        background: url("https://i.loli.net/2019/07/22/5d3521411f3f169375.png");
        background-repeat: no-repeat;
        background-position: 50% 0;
        -ms-background-size: cover;
        -o-background-size: cover;
        -moz-background-size: cover;
        -webkit-background-size: cover;
        background-size: cover;
    }
    

    
</style>







</html>
